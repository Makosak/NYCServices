<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="robots" content="noindex, nofollow">
    <title>Password Protected Page</title>
    <style>
        html, body {
            margin: 0;
            width: 100%;
            height: 100%;
            font-family: Arial, Helvetica, sans-serif;
        }
        #dialogText {
            padding: 10px 30px;
            color: white;
            background-color: #333333;
        }
        
        #dialogWrap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: table;
            background-color: #EEEEEE;
        }
        
        #dialogWrapCell {
            display: table-cell;
            text-align: center;
            vertical-align: middle;
        }
        
        #mainDialog {
            width: 500px;
            border: solid #AAAAAA 1px;
            border-radius: 10px;
            box-shadow: 3px 3px 5px 3px #AAAAAA;
            margin-left: auto;
            margin-right: auto;
            background-color: #FFFFFF;
            overflow: hidden;
            text-align: left;
        }
        #passArea {
            padding: 20px 30px;
            background-color: white;
        }
        #passArea > * {
            margin: 5px auto;
        }
        #pass {
            width: 100%;
            height: 40px;
            font-size: 30px;
        }
        
        #messageWrapper {
            float: left;
            vertical-align: middle;
            line-height: 30px;
        }
        
        .notifyText {
            display: none;
        }
        
        #invalidPass {
            color: red;
        }
        
        #success {
            color: green;
        }
        
        #submitPass {
            font-size: 20px;
            border-radius: 5px;
            background-color: #E7E7E7;
            border: solid gray 1px;
            float: right;
        }
        #contentFrame {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
  </head>
  <body>
    <iframe id="contentFrame" frameBorder="0"></iframe>
    <div id="dialogWrap">
        <div id="dialogWrapCell">
            <div id="mainDialog">
                <div id="dialogText">This page is password protected.</div>
                <div id="passArea">
                    <p id="passwordPrompt">Password</p>
                    <input id="pass" type="password" name="pass">
                    <div>
                        <span id="messageWrapper">
                            <span id="invalidPass" class="notifyText">Sorry, please try again.</span>
                            <span id="success" class="notifyText">Success!</span>
                            &nbsp;
                        </span>
                        <button id="submitPass" type="button">Submit</button>
                        <div style="clear: both;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/pbkdf2.js"></script>
    <script>
        /*! srcdoc-polyfill - v0.1.1 - 2013-03-01
        * http://github.com/jugglinmike/srcdoc-polyfill/
        * Copyright (c) 2013 Mike Pennisi; Licensed MIT */
        (function( window, document, undefined ) {
	
	        var idx, iframes;
	        var _srcDoc = window.srcDoc;
	        var isCompliant = !!("srcdoc" in document.createElement("iframe"));
	        var implementations = {
		        compliant: function( iframe, content ) {

			        if (content) {
				        iframe.setAttribute("srcdoc", content);
			        }
		        },
		        legacy: function( iframe, content ) {

			        var jsUrl;

			        if (!iframe || !iframe.getAttribute) {
				        return;
			        }

			        if (!content) {
				        content = iframe.getAttribute("srcdoc");
			        } else {
				        iframe.setAttribute("srcdoc", content);
			        }

			        if (content) {
				        // The value returned by a script-targeted URL will be used as
				        // the iFrame's content. Create such a URL which returns the
				        // iFrame element's `srcdoc` attribute.
				        jsUrl = "javascript: window.frameElement.getAttribute('srcdoc');";

				        iframe.setAttribute("src", jsUrl);

				        // Explicitly set the iFrame's window.location for
				        // compatability with IE9, which does not react to changes in
				        // the `src` attribute when it is a `javascript:` URL, for
				        // some reason
				        if (iframe.contentWindow) {
					        iframe.contentWindow.location = jsUrl;
				        }
			        }
		        }
	        };
	        var srcDoc = window.srcDoc = {
		        // Assume the best
		        set: implementations.compliant,
		        noConflict: function() {
			        window.srcDoc = _srcDoc;
			        return srcDoc;
		        }
	        };

	        // If the browser supports srcdoc, no shimming is necessary
	        if (isCompliant) {
		        return;
	        }

	        srcDoc.set = implementations.legacy;

	        // Automatically shim any iframes already present in the document
	        iframes = document.getElementsByTagName("iframe");
	        idx = iframes.length;

	        while (idx--) {
		        srcDoc.set( iframes[idx] );
	        }

        }( this, this.document ));
    </script>
    <script>
        var pl = {"salt":"o9YPrbormMisIOKp1JofvTyIuh8OpcFLykE2RxJ08o8=","iv":"LW9SVXmg0MGyGZ1DPDy2Kw==","data":"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"};
        
        var submitPass = document.getElementById('submitPass');
        var passEl = document.getElementById('pass');
        var invalidPassEl = document.getElementById('invalidPass');
        var successEl = document.getElementById('success');
        var contentFrame = document.getElementById('contentFrame');
        
        if (pl === "") {
            submitPass.disabled = true;
            passEl.disabled = true;
            alert("This page is meant to be used with the encryption tool. It doesn't work standalone.");
        }
        
        function doSubmit(evt) {
            try {
                var decrypted = decryptFile(CryptoJS.enc.Base64.parse(pl.data), passEl.value, CryptoJS.enc.Base64.parse(pl.salt), CryptoJS.enc.Base64.parse(pl.iv));
                if (decrypted === "") throw "No data returned";
                
                // Set default iframe link targets to _top so all links break out of the iframe
                decrypted = decrypted.replace("<head>", "<head><base href=\".\" target=\"_top\">");
                
                srcDoc.set(contentFrame, decrypted);
                
                successEl.style.display = "inline";
                passEl.disabled = true;
                submitPass.disabled = true;
                setTimeout(function() {
                    dialogWrap.style.display = "none";
                }, 1000);
            } catch (e) {
                invalidPassEl.style.display = "inline";
                passEl.value = "";
            }
        }
        
        submitPass.onclick = doSubmit;
        passEl.onkeypress = function(e){
            if (!e) e = window.event;
            var keyCode = e.keyCode || e.which;
            invalidPassEl.style.display = "none";
            if (keyCode == '13'){
              // Enter pressed
              doSubmit();
              return false;
            }
        }
        
        function decryptFile(contents, password, salt, iv) {
            var _cp = CryptoJS.lib.CipherParams.create({
                ciphertext: contents
            });
            var key = CryptoJS.PBKDF2(password, salt, { keySize: 256/32, iterations: 100 });
            var decrypted = CryptoJS.AES.decrypt(_cp, key, {iv: iv});
            
            return decrypted.toString(CryptoJS.enc.Utf8);
        }
    </script>
  </body>
</html>
